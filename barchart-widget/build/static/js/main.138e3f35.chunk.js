(this["webpackJsonpvizzion-client"]=this["webpackJsonpvizzion-client"]||[]).push([[0],{13:function(e,t,a){},16:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(7),c=a.n(r),i=a(1),s=(a(13),a(26)),l=Object(s.a)({seat:function(e){return{height:20,minWidth:"4%",margin:"0.2%",backgroundColor:e.color,flexShrink:1}}}),u=function(e){var t=l(e);return o.a.createElement("div",{key:"".concat(e.party,"-").concat(e.el),className:t.seat})},m=Object(s.a)({partyContainer:{width:"20%"},party:function(e){return{display:"flex",alignItems:"center",fontWeight:"bold",letterSpacing:2,padding:"5px 5px",margin:1,borderRadius:5,color:"white",justifyItems:"center",justifyContent:"space-between",backgroundColor:e.color}},popVote:{padding:5,fontWeight:"bold"}}),f=function(e){var t=m(e);return o.a.createElement("div",{className:t.partyContainer},o.a.createElement("div",{className:t.party},o.a.createElement("div",null,e.name),o.a.createElement("div",null,e.seats)),o.a.createElement("div",{className:t.popVote},"Pop vote: ",e.votes,"%"))},d=a(4),p=Object(s.a)({meter:{maxWidth:"90%",position:"relative",minHeight:"20px"},bar:{background:function(e){return e.color},width:function(e){return e.votes},borderRadius:"0px 5px 5px 0px",height:10,margin:2,animationName:"animate-bar",animationDuration:"0.5s"},majorityLine:{position:"absolute",height:"120%",minHeight:"20px",bottom:-2,borderLeft:"2px solid black"},majorityLabel:{position:"absolute",textAlign:"left",bottom:50,marginLeft:-7,fontWeight:"bolder"}});function v(e){e.color,e.votes;var t=Object(d.a)(e,["color","votes"]),a=p(e);return o.a.createElement("div",Object.assign({className:"animate-bar ".concat(a.bar)},t))}var b=function(e){var t=Object(n.useState)(0),a=Object(i.a)(t,2),r=a[0],c=a[1],s=Object(n.useState)(50),l=Object(i.a)(s,2),u=l[0],m=l[1],f=Object(n.useState)(0),d=Object(i.a)(f,2),b=d[0],y=d[1],g=p(e);Object(n.useEffect)((function(){if(e.data){var t=e.data.partyResults[0],a=e.majority/e.seatTotal*100;if(t.seats>e.majority){var n=100-t.seats/e.seatTotal*100;console.log(n),c(n),y(t.seats),m(a+n)}else c(-1),m(100)}}),[e.data]);var h=e.majority/e.seatTotal*100;return o.a.createElement("div",{className:g.meter},o.a.createElement("div",{className:g.majorityLabel,style:{left:"".concat(u,"%")}},e.majority," seats needed for majority"),e.data&&e.data.partyResults.map((function(t,a){if(0===a){var n=100-t.seats/e.seatTotal*100;if(console.log(n),t.seats,h="".concat(t.seats/e.seatTotal*100,"%"),r>0)return o.a.createElement(v,{color:t.color,votes:"".concat(t.seats/e.seatTotal*100+r,"%")});if(r<0)return o.a.createElement(v,{color:t.color,votes:"".concat(t.seats/e.majority*100,"%")})}else if(a<3&&t.seats>0){if(r>0)return o.a.createElement(v,{color:t.color,votes:"".concat(t.seats/b*100,"%")});if(r<0)return o.a.createElement(v,{color:t.color,votes:"".concat(t.seats/e.majority*100,"%")})}})),console.log("majority",h),o.a.createElement("div",{className:g.majorityLine,style:{left:"".concat(u,"%")}}))},y=Object(s.a)({main:{display:"flex",position:"relative",flexDirection:"column",padding:"20px 30px",backgroundColor:"#ededf0"},titleRow:{display:"flex",padding:"0px 5px 5px 5px",justifyContent:"space-between"},title:{fontSize:function(e){return e.small?20:26},fontWeight:"bold"},barchart:{fontSize:function(e){return e.small?11:14},display:"flex",padding:"30px 0",flexDirection:"column-reverse",flexWrap:"wrap"},partyMap:{fontSize:function(e){return e.small?14:18},display:"flex",justifyContent:"space-evenly"},update:{padding:"15px 5px",fontSize:function(e){return e.small?12:14}}}),g=function(e){var t=y(e),a=Object(n.useState)(null),r=Object(i.a)(a,2),c=r[0],s=r[1],l=Object(n.useState)(""),m=Object(i.a)(l,2),d=m[0],p=m[1],v=Object(n.useState)(3e5),g=Object(i.a)(v,2),h=g[0],j=(g[1],Object(n.useState)(49)),x=Object(i.a)(j,2),E=x[0];x[1];Object(n.useEffect)((function(){console.log("Updating every ".concat(h/1e3," seconds")),fetch("/title").then((function(e){return e.text()})).then((function(e){return p(e)})).catch((function(e){return console.log("error setting title")})),O(),S()}),[]);var O=function(){setInterval((function(){S()}),1e4)},S=function(){console.log("fetching"),fetch("/overallresults").then((function(e){if(e.ok)return e.json()})).then((function(e){return s(e)})).catch((function(e){console.log("Error fetching results")}))},N=[],k=[],w="";if(c){if(c.partyResults.map((function(e,t){for(var a=0;a<e.seats;a++)N.push(o.a.createElement(u,{key:"".concat(e.nameShort,"-").concat(a),color:e.color}));k.push(o.a.createElement(f,{key:"".concat(e,"-").concat(t),name:e.nameShort,seats:e.seats,votes:e.votesPercent,color:e.color}))})),N.length<E+1)for(var z=E-N.length,C=0;C<z;C++)N.push(o.a.createElement(u,{key:"none-".concat(C),color:"#cccccc"}));w=new Date(c.generated)}else for(var R=0;R<E;R++)N.push(o.a.createElement(u,{key:"none-".concat(R),color:"#cccccc"}));return o.a.createElement("div",{className:t.main},o.a.createElement("div",{className:t.titleRow},o.a.createElement("div",{className:t.title},d)),c&&c.partyResults[0].seats>0&&o.a.createElement("div",{className:t.barchart},o.a.createElement(b,{seatTotal:E,majority:25,majorityPercent:25/E*100,data:c})),o.a.createElement("div",{className:t.partyMap},k),c&&o.a.createElement("div",{className:t.update},"Last updated: ",w&&w.toString()))},h=window.screen.width<500;c.a.render(o.a.createElement(g,{small:h?"true":void 0}),document.getElementById("root"))},8:function(e,t,a){e.exports=a(16)}},[[8,1,2]]]);
//# sourceMappingURL=main.138e3f35.chunk.js.map