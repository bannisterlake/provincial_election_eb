(this["webpackJsonpvizzion-client"]=this["webpackJsonpvizzion-client"]||[]).push([[0],{162:function(t,e,a){t.exports=a(395)},167:function(t,e,a){},395:function(t,e,a){"use strict";a.r(e);var n=a(1),o=a.n(n),i=a(157),r=a.n(i),c=a(18),l=(a(167),a(406)),s=a(80),u=a.n(s),d=(a(184),Object(l.a)({seat:function(t){return{height:20,minWidth:"4%",margin:"0.2%",backgroundColor:t.color,flexShrink:1,fontSize:function(t){return"true"===t.small?8:10}}}}),Object(l.a)({partyContainer:{width:"20%"},party:function(t){return{display:"flex",alignItems:"center",fontWeight:"bold",letterSpacing:2,padding:"5px 5px",margin:1,borderRadius:5,color:"white",justifyItems:"center",justifyContent:"space-between",backgroundColor:t.color}},popVote:{padding:5,fontWeight:"bold"}})),m=function(t){var e=d(t);return o.a.createElement("div",{className:e.partyContainer},o.a.createElement("div",{className:e.party},o.a.createElement("div",null,t.name),o.a.createElement("div",null,t.seats)),o.a.createElement("div",{className:e.popVote},t.small?"".concat(t.votes,"%"):"Pop vote: ".concat(t.votes,"%")))},f=a(109),p=Object(l.a)({meter:{maxWidth:"95%",position:"relative",minHeight:"20px"},bar:{background:function(t){return t.color},width:function(t){return t.votes},borderRadius:"0px 5px 5px 0px",height:10,margin:2,animationName:"animate-bar",animationDuration:"0.5s",transition:"width 300ms ease-in-out",transitionDelay:"100ms",zIndex:20},majorityLine:{position:"absolute",height:"120%",minHeight:"20px",bottom:-2,borderLeft:"2px solid black",transition:"left 300ms ease-in-out"},majorityLabel:{position:"absolute",textAlign:"left",top:-25,marginLeft:-7,fontWeight:"bolder",transition:"right 300ms ease-in-out"}});function g(t){t.color,t.votes;var e=Object(f.a)(t,["color","votes"]),a=p(t);return o.a.createElement("div",Object.assign({className:"animate-bar ".concat(a.bar)},e))}var b=function(t){var e=Object(n.useState)(25),a=Object(c.a)(e,2),i=a[0],r=a[1],l=Object(n.useState)(0),s=Object(c.a)(l,2),u=(s[0],s[1],Object(n.useState)(50)),d=Object(c.a)(u,2),m=d[0],f=d[1],b=Object(n.useState)(0),v=Object(c.a)(b,2),j=(v[0],v[1],p(t));Object(n.useEffect)((function(){if(t.data){var e=t.data.partyResults[0];console.log("leading",t.majority,e.seats),e.seats>=t.majority?(r(e.seats),f(t.majority/e.seats*100)):(r(t.majority),f(t.majority/t.majority*100))}}),[t.data,t.seatTotal]);t.majority,t.seatTotal;return o.a.createElement("div",{className:j.meter},o.a.createElement("div",{className:j.majorityLabel,style:{right:"".concat(100-m,"%")}},t.majority," seats needed for majority"),t.data&&t.data.partyResults.map((function(t,e){if(console.log("max seats",i),e<4)return o.a.createElement(g,{color:t.color,votes:t.seats>0?"".concat(t.seats/i*100,"%"):"1%"})})),o.a.createElement("div",{className:j.majorityLine,style:{left:"".concat(m,"%")}}))},v=a(158),j=a.n(v),h=Object(l.a)({root:{display:"flex",alignItems:"center",paddingBottom:15,fontWeight:"bolder",alignSelf:"flex-start",fontSize:14,paddingLeft:5,"& svg":{color:"green",fontSize:20,paddingRight:5}}}),y=function(t){var e=h();return o.a.createElement("div",{className:t.declarationText&&e.root},o.a.createElement(j.a,{color:"green"}),t.declarationText)};a(392);var x=Object(l.a)({main:{display:"flex",position:"relative",flexDirection:"column",padding:"10px 10px",backgroundColor:"#ededf0"},titleRow:{display:"flex",padding:"0px 5px 5px 5px",justifyContent:"space-between"},title:{fontSize:24,fontWeight:"bold"},barchart:{fontSize:14,display:"flex",padding:"20px 0",flexDirection:"column-reverse",flexWrap:"wrap"},partyMap:{fontSize:16,display:"flex",flexWrap:"wrap",alignContent:"left"},update:{padding:"15px 5px",fontSize:10}}),O=function(t){var e=x(t),a=Object(n.useState)(null),i=Object(c.a)(a,2),r=i[0],l=i[1],s=Object(n.useState)(null),d=Object(c.a)(s,2),f=d[0],p=d[1],g=Object(n.useState)(""),v=Object(c.a)(g,2),j=v[0],h=v[1],O=Object(n.useState)(3e4),E=Object(c.a)(O,2),S=E[0],w=(E[1],Object(n.useState)(0)),N=Object(c.a)(w,2),z=N[0],R=N[1],W=Object(n.useState)(0),k=Object(c.a)(W,2),C=k[0],L=k[1],T=Object(n.useState)(""),I=Object(c.a)(T,2),D=I[0],P=I[1];Object(n.useEffect)((function(){var t="nb";try{t=window.location.search.split("/").find((function(t){return t.includes("?prov=")})).split("=")[1]}catch(e){console.log("default province")}console.log("Updating every ".concat(S/1e3," seconds")),u.a.get("/".concat(t,"/config")).then((function(t){200===t.status&&(h(t.data.title),R(t.data.seats),L(t.data.majority))})).catch((function(t){return console.log("error setting title")})),B(),H()}),[]),Object(n.useEffect)((function(){try{if(r&&f)if(f.overallResult.partyName&&f.overallResult.resultText){var t=f.overallResult.partyName+" "+f.overallResult.resultText;console.log(t),P(t)}else P("")}catch(e){}}),[r,f]);var B=function(){setInterval((function(){H()}),S)},H=function(){var t="nb";try{t=window.location.search.split("/").find((function(t){return t.includes("?prov=")})).split("=")[1]}catch(e){console.log("default province")}console.log("fetching"),u.a.get("/".concat(t,"/overallresults")).then((function(t){console.log(t.data),200===t.status&&l(t.data)})).catch((function(t){console.log("Error fetching results")})),u.a.get("/".concat(t,"/declaration")).then((function(t){console.log(t.data),200===t.status&&p(t.data)})).catch((function(t){console.log("Error fetching results")}))},J=[],M="";return r&&(r.partyResults.map((function(e,a){J.push(o.a.createElement(m,{small:t.small,key:"".concat(e,"-").concat(a),name:e.nameShort,seats:e.seats,votes:e.votesPercent,color:e.color}))})),M=new Date(r.generated)),o.a.createElement("div",{className:e.main},o.a.createElement("div",{className:e.titleRow},o.a.createElement("div",{className:e.title},j)),D&&o.a.createElement(y,{declarationText:D}),r&&o.a.createElement("div",{className:e.barchart},o.a.createElement(b,{seatTotal:z,majority:C,majorityPercent:C/z*100,data:r})),o.a.createElement("div",{className:e.partyMap},J),r&&o.a.createElement("div",{className:e.update},"Last updated: ",M&&M.toString()))},E=window.innerWidth<500;console.log(window),r.a.render(o.a.createElement(O,{small:E?"true":void 0}),document.getElementById("root"))}},[[162,1,2]]]);
//# sourceMappingURL=main.4e048794.chunk.js.map