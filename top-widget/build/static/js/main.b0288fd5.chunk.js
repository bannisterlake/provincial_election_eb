(this["webpackJsonpvizzion-client"]=this["webpackJsonpvizzion-client"]||[]).push([[0],{31:function(e,t,a){e.exports=a(61)},36:function(e,t,a){},61:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(26),r=a.n(c),l=a(4),i=(a(36),a(72)),s=a(14),u=a.n(s),d=Object(i.a)({seat:{height:function(e){return e.small?10:15},minWidth:"4%",margin:"0.1%",backgroundColor:function(e){return e.color},flexShrink:1,fontSize:16}}),m=function(e){var t=d(e);return o.a.createElement("div",{key:"".concat(e.party,"-").concat(e.el),className:t.seat})},f=Object(i.a)({partyContainer:{width:"20%",paddingTop:5},party:function(e){return{display:"flex",alignItems:"center",fontWeight:"bold",fontSize:14,letterSpacing:2,padding:"5px 5px",margin:1,borderRadius:5,color:"white",justifyItems:"center",justifyContent:"space-between",backgroundColor:e.color}},popVote:function(e){return{padding:5,fontWeight:"bold",fontSize:14}}}),p=function(e){var t=f(e);return o.a.createElement("div",{className:t.partyContainer},o.a.createElement("div",{className:t.party},o.a.createElement("div",null,e.name),o.a.createElement("div",null,e.seats)),o.a.createElement("div",{className:t.popVote},"true"===e.small?" ".concat(e.votes,"%"):"Pop vote: ".concat(e.votes,"%")))},g=a(15),v=Object(i.a)({meter:function(e){return{width:120,marginLeft:10,position:"relative"}},bar:{background:function(e){return e.color},width:function(e){return e.votes},borderRadius:"0px 5px 5px 0px",height:5,margin:1},majorityLine:{position:"absolute",height:"120%",bottom:-2,borderLeft:function(e){return e.small?"1px solid black":"2px solid black"}},majorityLabel:function(e){return{position:"absolute",textAlign:"center",marginTop:e.small?-14:-18,marginLeft:e.small?-3:-4,fontSize:12,fontWeight:"bolder"}}});function b(e){e.color,e.votes;var t=Object(g.a)(e,["color","votes"]),a=v(e);return o.a.createElement("div",Object.assign({className:a.bar},t))}var j=function(e){var t=Object(n.useState)(25),a=Object(l.a)(t,2),c=a[0],r=a[1],i=Object(n.useState)(0),s=Object(l.a)(i,2),u=(s[0],s[1],Object(n.useState)(50)),d=Object(l.a)(u,2),m=d[0],f=d[1],p=Object(n.useState)(0),g=Object(l.a)(p,2),j=(g[0],g[1],v(e));return Object(n.useEffect)((function(){if(e.data){var t=e.data.partyResults[0];console.log("leading",e.majority,t.seats),t.seats>=e.majority?(r(t.seats),f(e.majority/t.seats*100)):(r(e.majority),f(e.majority/e.majority*100))}}),[e.data]),o.a.createElement("div",{className:j.meter},e.data&&e.data.partyResults.map((function(e,t){if(console.log("max seats",c),t<4)return o.a.createElement(b,{color:e.color,votes:"".concat(e.seats/c*100,"%")})})),o.a.createElement("div",{className:j.majorityLine,style:{left:"".concat(m,"%")}}))},h=a(27),y=a.n(h),x=Object(i.a)({root:{display:"flex",alignItems:"center",fontWeight:"bolder",alignSelf:"flex-start",fontSize:14,padding:5,"& svg":{color:"green",fontSize:20,paddingRight:5}}}),E=function(e){var t=x();return o.a.createElement("div",{className:e.declarationText&&t.root},o.a.createElement(y.a,{color:"green"}),e.declarationText)},O=Object(i.a)({main:{display:"flex",position:"relative",flexDirection:"column",padding:"10px 10px",backgroundColor:"#ededf0"},titleRow:{display:"flex",padding:"0px 5px",justifyContent:"space-between"},title:function(e){return{fontSize:e.small?18:24,fontWeight:"bold",paddingRight:20}},majorityMeter:function(e){return{display:"flex",alignItems:"center",textAlign:"right",fontSize:12}},seatMap:{display:"flex",height:90,maxHeight:function(e){return e.small?50:100},flexDirection:"column-reverse",flexWrap:"wrap"},partyMap:{display:"flex",justifyContent:"flex-start"},update:function(e){return{fontSize:11}}}),S=function(e){var t=O(e),a=Object(n.useState)(null),c=Object(l.a)(a,2),r=c[0],i=c[1],s=Object(n.useState)(""),d=Object(l.a)(s,2),f=d[0],g=d[1],v=Object(n.useState)(3e4),b=Object(l.a)(v,2),h=b[0],y=(b[1],Object(n.useState)(49)),x=Object(l.a)(y,2),S=x[0],w=x[1],N=Object(n.useState)(25),k=Object(l.a)(N,2),z=k[0],R=k[1],C=Object(n.useState)(""),T=Object(l.a)(C,2),W=T[0],L=T[1],I=Object(n.useState)(null),M=Object(l.a)(I,2),D=M[0],P=M[1];Object(n.useEffect)((function(){console.log("Updating every ".concat(h/1e3," seconds"));var e="nb";try{e=window.location.search.split("/").find((function(e){return e.includes("?prov=")})).split("=")[1]}catch(t){console.log("default province")}u.a.get("/".concat(e,"/config")).then((function(e){200===e.status&&(g(e.data.title),R(e.data.majority),w(e.data.seats))})).catch((function(e){return console.log("error setting title")})),A(),J()}),[]),Object(n.useEffect)((function(){console.log("check declaration",r,D);try{if(r&&D)if(D.overallResult.partyName&&D.overallResult.resultText){var e=D.overallResult.partyName+" "+D.overallResult.resultText;console.log(e),L(e)}else L("")}catch(t){}}),[r,D]);var A=function(){setInterval((function(){J()}),h)},J=function(){var e="nb";try{e=window.location.search.split("/").find((function(e){return e.includes("?prov=")})).split("=")[1]}catch(t){console.log("default province")}u.a.get("/".concat(e,"/overallresults")).then((function(e){200===e.status&&i(e.data)})).catch((function(e){return console.log("Error fetching overall results")})),u.a.get("/".concat(e,"/declaration")).then((function(e){console.log(e.data),200===e.status&&P(e.data)})).catch((function(e){console.log("Error fetching results")}))},V=[],B=[],H="";if(r){if(r.partyResults.map((function(t){for(var a=0;a<t.seats;a++)V.push(o.a.createElement(m,{key:"".concat(t.nameShort,"-").concat(a),color:t.color,small:e.small}));B.push(o.a.createElement(p,{key:t.id,name:t.nameShort,seats:t.seats,votes:t.votesPercent,color:t.color,small:e.small}))})),V.length<S+1){console.log(V.length);for(var U=S-V.length,q=0;q<U;q++)V.push(o.a.createElement(m,{small:e.small,key:"none-".concat(q),color:"#cccccc"}))}H=new Date(r.generated)}else for(var F=0;F<S;F++)V.push(o.a.createElement(m,{key:"none-".concat(F),small:e.small,color:"#cccccc"}));return o.a.createElement("div",{className:t.main},o.a.createElement("div",{className:t.titleRow},o.a.createElement("div",{className:t.title},f),r&&o.a.createElement("div",{className:t.majorityMeter},z," seats needed for majority",o.a.createElement(j,{seatTotal:S,majority:25,majorityPercent:25/S*100,data:r}))),W&&o.a.createElement(E,{declarationText:W}),o.a.createElement("div",{className:t.seatMap},V),o.a.createElement("div",{className:t.partyMap},B),r&&o.a.createElement("div",{className:t.update},"Last updated: ",H&&H.toString()))},w=window.innerWidth<500;r.a.render(o.a.createElement(S,{small:w?"true":void 0}),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.b0288fd5.chunk.js.map