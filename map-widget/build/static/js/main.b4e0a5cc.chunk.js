(this["webpackJsonpvizzion-client"]=this["webpackJsonpvizzion-client"]||[]).push([[0],{48:function(e,t,n){e.exports=n(62)},53:function(e,t,n){},54:function(e,t,n){},62:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(12),i=n.n(o),l=(n(53),n(10)),c=(n(54),n(75)),s=n(36),d=n.n(s),u=n(33),m=n(34),f=n(32),p=n(37),g=n.n(p),h=n(3),v=n.n(h),E=n(41),b=n.n(E),y=Object(c.a)({geoTooltip:{fontFamily:"Roboto, Ubuntu, Helvetica",display:"flex",flexDirection:"column",transition:"1s"},tooltipName:{fontSize:20,fontWeight:"bolder"},tooltipPolls:{fontSize:14,color:"grey",paddingBottom:10},tooltipWinner:{backgroundColor:function(e){return e.color},color:"white",padding:5,"& #tooltipPartyCode":{fontSize:18},"& #tooltipWinnerName":{fontSize:20,fontWeight:"bolder"}}}),S=function(e){var t=y(e);return r.a.createElement("div",{className:t.geoTooltip},r.a.createElement("div",{className:t.tooltipName},e.results.name),r.a.createElement("div",{className:t.tooltipPolls},e.results.pollsReported,"/",e.results.pollsTotal," polls reported"),e.results.pollsReported>0&&r.a.createElement("div",{className:t.tooltipWinner,style:{backgroundColor:e.color}},r.a.createElement("div",{id:"tooltipPartycode"},e.results.results[0].partyCode),r.a.createElement("div",{id:"tooltipWinnerName"},e.results.results[0].name)))},j=Object(c.a)({mapContainer:{flex:4,position:"relative"},resetButton:{display:"flex",boxShadow:"0 1px 4px rgba(0,0,0,0.65)",height:26,width:26,fontSize:14,alignItems:"center",justifyContent:"center",borderRadius:"4px",background:"#FFFFFF",cursor:"pointer",color:"black"}}),O={weight:.9,color:"black",fillOpacity:.9},N={weight:3,fillOpacity:1},C=function(e){var t=Object(a.useState)(),n=Object(l.a)(t,2),o=n[0],i=n[1],c=Object(a.useState)(),s=Object(l.a)(c,2),p=s[0],h=s[1],E=Object(a.useState)(null),y=Object(l.a)(E,2),C=y[0],x=y[1],w=Object(a.useRef)(null),z=Object(a.useRef)(null),R=j();Object(a.useEffect)((function(){console.log("render map"),w&&fetch("/geojson").then((function(e){return e.json()})).then((function(e){x(e);var t=v.a.geoJSON(e).getBounds();i(t),w.current.leafletElement.fitBounds(t)}))}),[e.data]),Object(a.useEffect)((function(){e.selectedRiding?(D(e.selectedRiding.name),z.current&&z.current.leafletElement.eachLayer((function(t){t.feature.properties.Name.toUpperCase()===e.selectedRiding.name.toUpperCase()&&t.setStyle({weight:3,fillOpacity:1})}))):I()}),[z.current,e.selectedRiding]);var k=function(t){try{if(e.data)return e.data.data.find((function(e){return e.name.toUpperCase()===t.toUpperCase()}))}catch(n){console.log("Couldn't get party results")}},L=function(t){try{if(e.parties&&t.results.length>0){var n=e.parties.find((function(e){if(t.results[0].votes>0)return e.nameShort===t.results[0].partyCode}));return n?n.color:"lightgrey"}return"lightgrey"}catch(a){return console.log("Error getting Geo Fill for ",t.name),"lightgrey"}},D=function(e){try{if(z.current){var t=w.current.leafletElement,n=z.current.leafletElement,a=null;n.eachLayer((function(t){t.feature.properties.Name.toUpperCase()===e.toUpperCase()&&(a=t)})),t.fitBounds(a.getBounds())}}catch(r){console.log("error zooming on riding")}},I=function(){try{w.current.leafletElement.fitBounds(o)}catch(e){}};return r.a.createElement("div",{className:R.mapContainer},r.a.createElement(u.a,{ref:w,zoomSnap:.25,zoomDelta:.5,minZoom:3},r.a.createElement(m.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png"}),C&&r.a.createElement(f.a,{ref:z,style:function(e){if(e){var t=k(e.properties.Name),n="lightgrey";return t&&(n=L(t)),{fillColor:n,weight:.9,color:"black",fillOpacity:.9}}},data:C,onClick:function(t){var n=t.layer.getBounds();if(p===n)t.layer.closeTooltip();else{var a=w.current.leafletElement;h(n),a.fitBounds(n);var r=t.layer.feature.properties.Name,o=k(r);e.handleSelectRiding(o),t.layer.setStyle(N)}},onEachFeature:function(e,t){if(e.properties)try{var n=k(e.properties.Name),a=L(n);n&&a&&t.bindTooltip(d.a.renderToString(r.a.createElement(S,{results:n,color:a})),{sticky:!1,direction:"top"})}catch(o){}},onMouseOver:function(e){e.layer.setStyle(N)},onMouseOut:function(t){e.selectedRiding?t.layer.feature.properties.PED_Name_E.toUpperCase()!==e.selectedRiding.name.toUpperCase()&&t.layer.setStyle(O):t.layer.setStyle(O)}}),r.a.createElement(g.a,{position:"topleft"},r.a.createElement("a",{id:"zoomOut",style:{color:"black !important"},className:"leaflet-control-zoom leaflet-bar ".concat(R.resetButton),onClick:I},r.a.createElement(b.a,null)))))},x=n(44),w=n.n(x),z=n(43),R=n.n(z),k=n(78),L=n(42),D=n.n(L),I=Object(c.a)((function(e){return{resultsRoot:{padding:10},candidateRoot:{position:"relative",display:"flex",flexDirection:"row",height:120,padding:"10px 0"},resultsInfo:{display:"flex",alignItems:"center",justifyContent:"space-between","& #pollsReported":{fontSize:12,fontWeight:"bolder"},"& #totalVotes":{fontSize:10,color:"darkslategrey"}},imageDiv:{height:function(e){return e.screensize<700?100:120},position:"relative",marginBottom:25,minWidth:50,width:function(e){return e.screensize<700?50:70},borderRadius:"8px",overflow:"hidden","& #partyCode":{position:"absolute",bottom:8,color:"white",width:"100%",textAlign:"center"},"& img":{width:"100%",height:"auto"}},candidateLeftDiv:{flex:3,display:"flex",flexDirection:"column",justifyContent:"space-between",padding:"10px 0 10px 10px","& #candidateIncumbent":{fontSize:13,fontWeight:"lighter"}},candidateName:{"& #candidateFirst":{fontWeight:"bolder",fontSize:function(e){return e.screensize<700?12:14}},"& #candidateLast":{fontWeight:"bolder",fontSize:function(e){return e.screensize<700?16:22}}},candidateRightDiv:{flex:2,justifySelf:"flex-end",display:"flex",flexDirection:"column",padding:"10px 0",justifyContent:"space-between","& #candidateElected":{display:"flex",alignItems:"center",justifyContent:"flex-end",fontSize:function(e){return e.screensize<700?12:14}}},votesDiv:{textAlign:"right","& #votesPercent":{fontSize:function(e){return e.screensize<700?16:22},fontWeight:"bolder"},"& #votesTotal":{fontSize:function(e){return e.screensize<700?12:14},fontWeight:"lighter"}}}})),W=function(e){var t=e.candidate,n=e.color,a=I(e);t.name.split(" ").pop();return r.a.createElement("div",{className:a.candidateRoot},r.a.createElement("div",{style:{backgroundColor:n},className:a.imageDiv},r.a.createElement("img",{alt:"Candidate Headshot",onError:function(e){e.target.onError=null,e.target.src="/img/images.jpg"},src:"/image/".concat(t.cachedHeadFilename)}),r.a.createElement("div",{id:"partyCode"},t.partyCode)),r.a.createElement("div",{className:a.candidateLeftDiv},r.a.createElement("div",{className:a.candidateName},r.a.createElement("div",{id:"candidateFirst"},t.firstName),r.a.createElement("div",{id:"candidateLast"},t.lastName)),r.a.createElement("div",{id:"candidateIncumbent"},t.isIncumbent&&"Incumbent")),r.a.createElement("div",{className:a.candidateRightDiv},r.a.createElement("div",{className:a.votesDiv},r.a.createElement("div",{id:"votesPercent"},t.percent,"%"),r.a.createElement("div",{id:"votesTotal"},t.votes.toLocaleString("en")," total votes")),t.isElected?r.a.createElement("div",{id:"candidateElected"},r.a.createElement(D.a,{style:{paddingRight:5,fontSize:14,color:"green"}})," Elected"):r.a.createElement("div",{style:{fontSize:14}})))},B=function(e){var t=I(),n=e.data;return r.a.createElement("div",{className:t.resultsRoot},e.data&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.resultsInfo},r.a.createElement("div",{id:"pollsReported"},n.pollsReported,"/",n.pollsTotal," polls reported"),r.a.createElement("div",{id:"totalVotes"},n.votes.toLocaleString("en")," total votes")),r.a.createElement("div",null,e.data.results.map((function(t,n){var a=function(t){var n="#595b5b";if(e.parties){var a=e.parties.find((function(e){return e.nameShort===t.partyCode}));a&&(n=a.color)}return n}(t);return r.a.createElement(W,{screensize:e.screensize,key:n,color:a,candidate:t})})))))},F=Object(c.a)({sidebar:{flex:2,position:"relative",display:"flex",overflow:"hidden"},title:{width:"100%",top:0,backgroundColor:"darkgrey",color:"white",display:"flex",alignItems:"center",minHeight:50,paddingLeft:10,fontWeight:"bolder"},content:{marginBottom:10,height:"calc(100% - 50px)",overflowX:"hidden",overflowY:"scroll"},LocationButton:{display:"flex",alignItems:"center",minHeight:50,paddingLeft:10,justifyContent:"space-between","&:hover":{backgroundColor:"lightgrey",cursor:"pointer"}}}),T=function(e){var t=Object(a.useState)(0),n=Object(l.a)(t,2),o=n[0],i=n[1],c=F(),s=Object(a.useState)("location"),d=Object(l.a)(s,2),u=d[0],m=d[1],f=Object(a.useState)(null),p=Object(l.a)(f,2),g=p[0],h=p[1];Object(a.useEffect)((function(){e.results&&(h(e.results),m("results"))}),[e.results]);var v=function(t){e.handleSelectRiding(t),h(t),m("results")},E=function(e){return r.a.createElement("div",{className:"".concat(c.LocationButton," menu-item"),onMouseEnter:function(){return i(e.resultId)},onMouseLeave:function(){return i(0)},onClick:function(){return v(e.resultData)}},e.children)};return r.a.createElement("div",{id:"widgetSidebar",className:c.sidebar},r.a.createElement("div",{style:{position:"absolute",top:0,height:"50px",width:"100%",backgroundColor:"darkgrey"}}),r.a.createElement(k.a,{in:"location"===u,timeout:500,unmountOnExit:!0,classNames:"menu-primary"},r.a.createElement("div",{className:"menu"},r.a.createElement("div",{className:c.title},"SELECT A RIDING"),r.a.createElement("div",{className:c.content},e.data&&e.data.data.sort((function(e,t){return e.name>t.name?1:-1})).map((function(e){return r.a.createElement(E,{key:e.id,resultId:e.id,resultData:e},e.name,o===e.id&&r.a.createElement(R.a,null))}))))),r.a.createElement(k.a,{in:"results"===u,unmountOnExit:!0,timeout:500,classNames:"menu-secondary"},r.a.createElement("div",{className:"menu"},r.a.createElement("div",{className:c.title},r.a.createElement(w.a,{onClick:function(){m("location"),e.handleSelectRiding(null)},style:{cursor:"pointer"}}),g&&g.name.toUpperCase()),r.a.createElement("div",{className:c.content},e.data&&"results"===u&&r.a.createElement(B,{screensize:e.small,data:g,parties:e.parties})))))},U=function(){return r.a.createElement("div",{className:"spinnerDiv"},r.a.createElement("div",{className:"spinnerText"},"Loading Map.."),r.a.createElement("div",{className:"spinner"},r.a.createElement("div",{className:"double-bounce1"}),r.a.createElement("div",{className:"double-bounce2"})))},H=(r.a.memo((function(e){var t=e.data;return r.a.createElement("div",{style:{display:"none"}},t.data.map((function(e){return e.results.map((function(e){return r.a.createElement("img",{alt:"Candidate Headshot",onError:function(e){e.target.onError=null,e.target.src="/img/images.jpg"},src:"/image/".concat(e.cachedHeadFilename)})}))})))})),Object(c.a)({app:{height:"100%",display:"flex",flexDirection:"row"}}));var M=function(){var e=Object(a.useState)(null),t=Object(l.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)(!0),c=Object(l.a)(i,2),s=c[0],d=c[1],u=Object(a.useState)(null),m=Object(l.a)(u,2),f=m[0],p=m[1],g=Object(a.useState)(null),h=Object(l.a)(g,2),v=h[0],E=h[1],b=Object(a.useState)(3e5),y=Object(l.a)(b,2),S=y[0],j=(y[1],Object(a.useState)(window.innerWidth)),O=Object(l.a)(j,2),N=O[0],x=(O[1],H());Object(a.useEffect)((function(){console.log("Updating every ".concat(S/1e3," seconds")),z(),w()}),[]),Object(a.useEffect)((function(){R()}),[s]);var w=function(){setInterval((function(){z()}),S)},z=function(){console.log("fetching"),fetch("/fullresults").then((function(e){return e.json()})).then((function(e){o(e),d(!1)})).catch((function(e){return console.log("Error fetching FULLELECTIONDATA, check your env variables and try again")})),fetch("/overallresults").then((function(e){return e.json()})).then((function(e){p(e.partyResults)})).catch((function(e){return console.log("Error fetching OVERALLRESULTS, check your env variables and try again")}))},R=function(){try{var e=window.location.hash;if(e){var t=e=decodeURI(e.replace("#",""));if(n){var a=n.data.find((function(e){return e.name.toLowerCase()===t.toLowerCase()}));a&&E(a)}}}catch(r){console.log("could not find riding by hash")}},k=function(e){E(e)};return r.a.createElement("div",{id:"map-widget-app",className:x.app},s?r.a.createElement(U,null):r.a.createElement(C,{data:n,parties:f,handleSelectRiding:k,selectedRiding:v}),r.a.createElement(T,{data:n,parties:f,results:v,handleSelectRiding:k,small:N}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[48,1,2]]]);
//# sourceMappingURL=main.b4e0a5cc.chunk.js.map