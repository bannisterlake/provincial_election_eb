(this["webpackJsonpvizzion-client"]=this["webpackJsonpvizzion-client"]||[]).push([[0],{69:function(e,t,a){e.exports=a(85)},74:function(e,t,a){},75:function(e,t,a){},85:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),i=a(13),r=a.n(i),l=(a(74),a(10)),c=(a(75),a(100)),s=(a(47),a(45),Object(c.a)({map:{display:"flex",height:"100%",flex:3}}),a(52)),d=a(53),u=a(51),m=a(58),f=a.n(m),p=a(3),g=a.n(p),h=a(59),v=a.n(h),b=Object(c.a)({mapContainer:{flex:4,position:"relative"},resetButton:{display:"flex",boxShadow:"0 1px 4px rgba(0,0,0,0.65)",height:26,width:26,fontSize:14,alignItems:"center",justifyContent:"center",borderRadius:"4px",background:"#FFFFFF",cursor:"pointer",color:"black"}}),E=function(e){var t=Object(n.useState)({lat:54,lng:-105,zoom:5}),a=Object(l.a)(t,2),i=(a[0],a[1],Object(n.useState)()),r=Object(l.a)(i,2),c=r[0],m=r[1],p=Object(n.useState)(null),h=Object(l.a)(p,2),E=h[0],y=h[1],j=Object(n.useRef)(null),x=Object(n.useRef)(null),O=b();Object(n.useEffect)((function(){j&&(console.log("here"),fetch("/SASK_Constituency_boundary.json").then((function(e){return e.json()})).then((function(e){y(e);var t=g.a.geoJSON(e).getBounds();m(t),j.current.leafletElement.fitBounds(t),console.log(g.a.geoJSON(e))})))}),[]),Object(n.useEffect)((function(){C()}),[e.data]),Object(n.useEffect)((function(){console.log("zoom to riding",e.selectedRiding),e.selectedRiding&&w(e.selectedRiding.name)}),[e.selectedRiding]);var S=function(t){try{if(e.data)return e.data.data.find((function(e){return e.name.toUpperCase()===t.toUpperCase()}))}catch(a){console.log("Couldn't get party results")}},C=function(t){if(t){var a=S(t.properties.Constituen),n="lightgrey";return a&&(n=function(t){if(e.parties){var a=e.parties.data.find((function(e){if(t.results[0].votes>0)return e.nameShort===t.results[0].partyCode}));return a?a.colour:"lightgrey"}}(a)),{fillColor:n,weight:.9,color:"black",fillOpacity:.8}}},w=function(e){var t=j.current.leafletElement,a=x.current.leafletElement,n=null;a.eachLayer((function(t){t.feature.properties.Constituen===e.toUpperCase()&&(n=t)})),t.fitBounds(n.getBounds())};return o.a.createElement("div",{className:O.mapContainer},o.a.createElement(s.a,{ref:j,maxBounds:[[29.305561325527698,-130.53515625000003],[74.16408546675687,-90.54296875000001]],minZoom:3},o.a.createElement(d.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png"}),E&&o.a.createElement(u.a,{ref:x,style:C,data:E,onClick:function(t){t.target.getBounds();var a=t.layer.getBounds();j.current.leafletElement.fitBounds(a);var n=t.layer.feature.properties.Constituen,o=S(n);e.handleSelectRiding(o)}}),o.a.createElement(f.a,{position:"topleft"},o.a.createElement("a",{id:"zoomOut",style:{color:"black !important"},className:"leaflet-control-zoom ".concat(O.resetButton),onClick:function(){j.current.leafletElement.fitBounds(c)}},o.a.createElement(v.a,null)))))},y=a(62),j=a.n(y),x=a(61),O=a.n(x),S=a(103),C=a(60),w=a.n(C),N=Object(c.a)({resultsRoot:{padding:10},candidateRoot:{position:"relative",display:"flex",flexDirection:"row",height:120,padding:"10px 0"},resultsInfo:{display:"flex",alignItems:"center",justifyContent:"space-between","& #pollsReported":{fontSize:14,fontWeight:"bolder"},"& #totalVotes":{fontSize:12,color:"darkslategrey"}},imageDiv:{height:"100%",position:"relative",paddingBottom:25,width:70,"& #partyCode":{position:"absolute",bottom:32,color:"white",width:"100%",textAlign:"center"},"& img":{borderRadius:"8px",backgroundColor:"red",paddingBottom:30,width:"100%",height:"auto"}},candidateLeftDiv:{flex:3,display:"flex",flexDirection:"column",justifyContent:"space-between",padding:"10px 0 10px 10px","& #candidateIncumbent":{fontSize:13,fontWeight:"lighter"}},candidateName:{"& #candidateFirst":{fontWeight:"bolder",fontSize:14},"& #candidateLast":{fontWeight:"bolder",fontSize:22}},candidateRightDiv:{flex:2,justifySelf:"flex-end",display:"flex",flexDirection:"column",padding:"10px 0",justifyContent:"space-between","& #candidateElected":{display:"flex",alignItems:"center",justifyContent:"flex-end",fontSize:14}},votesDiv:{textAlign:"right","& #votesPercent":{fontSize:22,fontWeight:"bolder"},"& #votesTotal":{fontSize:14,fontWeight:"lighter"}}}),R=function(e){var t=e.candidate,a=(e.color,N());return o.a.createElement("div",{className:a.candidateRoot},o.a.createElement("div",{className:a.imageDiv},o.a.createElement("img",{style:{backgroundColor:e.color},src:"/images.jpg"}),o.a.createElement("div",{id:"partyCode"},t.partyCode)),o.a.createElement("div",{className:a.candidateLeftDiv},o.a.createElement("div",{className:a.candidateName},o.a.createElement("div",{id:"candidateFirst"},t.name.split(" ")[0]),o.a.createElement("div",{id:"candidateLast"},t.name.split(" ")[t.name.split(" ").length-1])),o.a.createElement("div",{id:"candidateIncumbent"},t.isIncumbent&&"Incumbent")),o.a.createElement("div",{className:a.candidateRightDiv},o.a.createElement("div",{className:a.votesDiv},o.a.createElement("div",{id:"votesPercent"},t.percent,"%"),o.a.createElement("div",{id:"votesTotal"},t.votes.toLocaleString("en")," total votes")),t.elected?o.a.createElement("div",{id:"candidateElected"},o.a.createElement(w.a,{style:{paddingRight:5,fontSize:14,color:"green"}})," Elected"):o.a.createElement("div",{style:{fontSize:14}})))},k=function(e){var t=N(),a=e.data;return o.a.createElement("div",{className:t.resultsRoot},e.data&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:t.resultsInfo},o.a.createElement("div",{id:"pollsReported"},a.pollsReported,"/",a.pollsTotal," polls reported"),o.a.createElement("div",{id:"totalVotes"},a.votes.toLocaleString("en")," total votes")),o.a.createElement("div",null,e.data.results.map((function(t){var a=function(t){var a="#595b5b";if(e.parties.data){console.log(e.parties.data);var n=e.parties.data.find((function(e){return e.nameShort===t.partyCode}));n&&(a=n.colour)}return a}(t);return o.a.createElement(R,{color:a,candidate:t})})))))},z=Object(c.a)({sidebar:{flex:2,position:"relative",display:"flex",overflow:"hidden"},title:{width:"100%",top:0,backgroundColor:"darkgrey",color:"white",display:"flex",alignItems:"center",height:50,paddingLeft:10,fontWeight:"bolder"},content:{marginBottom:10,height:"calc(100% - 50px)",overflowX:"hidden",overflowY:"scroll"},LocationButton:{display:"flex",alignItems:"center",height:50,paddingLeft:10,justifyContent:"space-between","&:hover":{backgroundColor:"lightgrey",cursor:"pointer"}}}),B=function(e){var t=Object(n.useState)("Select a riding"),a=Object(l.a)(t,2),i=a[0],r=(a[1],Object(n.useState)(0)),c=Object(l.a)(r,2),s=c[0],d=c[1],u=z(),m=Object(n.useState)("location"),f=Object(l.a)(m,2),p=f[0],g=f[1],h=Object(n.useState)(null),v=Object(l.a)(h,2),b=v[0],E=v[1];Object(n.useEffect)((function(){e.results&&(console.log("setting results"),E(e.results),g("results"))}),[e.results]);var y=function(t){e.handleSelectRiding(t),E(t),g("results")},x=function(e){return o.a.createElement("div",{className:"".concat(u.LocationButton," menu-item"),onMouseEnter:function(){return d(e.resultId)},onMouseLeave:function(){return d(0)},onClick:function(){return y(e.resultData)}},e.children)};return o.a.createElement("div",{id:"widgetSidebar",className:u.sidebar},o.a.createElement("div",{style:{position:"absolute",top:0,height:"50px",width:"100%",backgroundColor:"darkgrey"}}),o.a.createElement(S.a,{in:"location"===p,timeout:500,unmountOnExit:!0,classNames:"menu-primary"},o.a.createElement("div",{className:"menu"},o.a.createElement("div",{className:u.title},i.toUpperCase()),o.a.createElement("div",{className:u.content},e.data&&e.data.data.map((function(e){return o.a.createElement(x,{resultId:e.id,resultData:e},e.name,s===e.id&&o.a.createElement(O.a,null))}))))),o.a.createElement(S.a,{in:"results"===p,unmountOnExit:!0,timeout:500,classNames:"menu-secondary"},o.a.createElement("div",{className:"menu"},o.a.createElement("div",{className:u.title},o.a.createElement(j.a,{onClick:function(){return g("location")},style:{cursor:"pointer"}}),b&&b.name.toUpperCase()),o.a.createElement("div",{className:u.content},e.data&&"results"===p&&o.a.createElement(k,{data:b,parties:e.parties})))))},D=Object(c.a)({app:{height:"100%",display:"flex",flexDirection:"row"}});var I=function(){var e=Object(n.useState)(null),t=Object(l.a)(e,2),a=t[0],i=t[1],r=Object(n.useState)(!0),c=Object(l.a)(r,2),s=(c[0],c[1]),d=Object(n.useState)(null),u=Object(l.a)(d,2),m=u[0],f=u[1],p=Object(n.useState)(null),g=Object(l.a)(p,2),h=g[0],v=g[1],b=D();Object(n.useEffect)((function(){return y()}),[]);var y=function(){fetch("/results_2016").then((function(e){return e.json()})).then((function(e){i(e),s(!1)})),fetch("/partylist").then((function(e){return e.json()})).then((function(e){f(e)}))},j=function(e){console.log(e),v(e)};return o.a.createElement("div",{id:"map-widget-app",className:b.app},o.a.createElement(E,{data:a,parties:m,handleSelectRiding:j,selectedRiding:h}),o.a.createElement(B,{data:a,parties:m,results:h,handleSelectRiding:j}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(I,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[69,1,2]]]);
//# sourceMappingURL=main.c5410435.chunk.js.map