(this["webpackJsonpvizzion-client"]=this["webpackJsonpvizzion-client"]||[]).push([[0],{246:function(e,t,n){e.exports=n(531)},251:function(e,t,n){},252:function(e,t,n){},531:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(39),r=n.n(i),c=(n(251),n(21)),l=(n(252),n(544)),s=n(90),d=n.n(s),u=(n(172),n(470),n(234),n(231)),m=n(232),f=n(235),g=n.n(f),p=n(4),v=n.n(p),h=n(239),b=n.n(h),E=(Object(l.a)({geoTooltip:{fontFamily:"Roboto, Ubuntu, Helvetica",display:"flex",flexDirection:"column",transition:"1s"},tooltipName:{fontSize:20,fontWeight:"bolder"},tooltipPolls:{fontSize:14,color:"grey",paddingBottom:10},tooltipWinner:{backgroundColor:function(e){return e.color},color:"white",padding:5,"& #tooltipPartyCode":{fontSize:18},"& #tooltipWinnerName":{fontSize:20,fontWeight:"bolder"}}}),Object(l.a)({mapContainer:{flex:4,position:"relative"},resetButton:{display:"flex",boxShadow:"0 1px 4px rgba(0,0,0,0.65)",height:26,width:26,fontSize:14,alignItems:"center",justifyContent:"center",borderRadius:"4px",background:"#FFFFFF",cursor:"pointer",color:"black"}})),y=function(e){var t=Object(a.useState)(),n=Object(c.a)(t,2),i=n[0],r=n[1],l=Object(a.useState)(),s=Object(c.a)(l,2),f=(s[0],s[1],Object(a.useState)(null)),p=Object(c.a)(f,2),h=(p[0],p[1]),y=Object(a.useRef)(null),j=Object(a.useRef)(null),S=E();Object(a.useEffect)((function(){console.log("render map");try{if(!y.current)return void console.log("no mapReff");d.a.get("/geojson").then((function(e){if(200===e.status){h(e.data);var t=v.a.geoJSON(e.data).getBounds();r(t),console.log("mapref",y),y.current.leafletElement.fitBounds(t)}})).catch((function(e){console.log(e),console.log("error getting geojson data")}))}catch(e){console.log("error getting geo data",y,j)}}),[e.data]);return o.a.createElement("div",{className:S.mapContainer},console.log(e),o.a.createElement(u.a,{ref:y,zoomSnap:.25,zoomDelta:.5,minZoom:3},o.a.createElement(m.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png"}),o.a.createElement(g.a,{position:"topleft"},o.a.createElement("a",{id:"zoomOut",style:{color:"black !important"},className:"leaflet-control-zoom leaflet-bar ".concat(S.resetButton),onClick:function(){try{y.current.leafletElement.fitBounds(i)}catch(e){}}},o.a.createElement(b.a,null)))))},j=n(242),S=n.n(j),O=n(241),x=n.n(O),w=n(547),N=n(240),z=n.n(N),C=Object(l.a)((function(e){return{resultsRoot:{padding:10},candidateRoot:{position:"relative",display:"flex",flexDirection:"row",height:120,padding:"10px 0"},resultsInfo:{display:"flex",alignItems:"center",justifyContent:"space-between","& #pollsReported":{fontSize:12,fontWeight:"bolder"},"& #totalVotes":{fontSize:10,color:"darkslategrey"}},imageDiv:{height:function(e){return e.screensize<700?100:120},position:"relative",marginBottom:25,minWidth:50,width:function(e){return e.screensize<700?50:70},borderRadius:"8px",overflow:"hidden","& #partyCode":{position:"absolute",bottom:8,color:"white",width:"100%",textAlign:"center"},"& img":{width:"100%",height:"auto"}},candidateLeftDiv:{flex:3,display:"flex",flexDirection:"column",justifyContent:"space-between",padding:"10px 0 10px 10px","& #candidateIncumbent":{fontSize:13,fontWeight:"lighter"}},candidateName:{"& #candidateFirst":{fontWeight:"bolder",fontSize:function(e){return e.screensize<700?12:14}},"& #candidateLast":{fontWeight:"bolder",fontSize:function(e){return e.screensize<700?16:22}}},candidateRightDiv:{flex:2,justifySelf:"flex-end",display:"flex",flexDirection:"column",padding:"10px 0",justifyContent:"space-between","& #candidateElected":{display:"flex",alignItems:"center",justifyContent:"flex-end",fontSize:function(e){return e.screensize<700?12:14}}},votesDiv:{textAlign:"right","& #votesPercent":{fontSize:function(e){return e.screensize<700?16:22},fontWeight:"bolder"},"& #votesTotal":{fontSize:function(e){return e.screensize<700?12:14},fontWeight:"lighter"}}}})),R=function(e){var t=e.candidate,n=e.color,a=C(e);t.name.split(" ").pop();return o.a.createElement("div",{className:a.candidateRoot},o.a.createElement("div",{style:{backgroundColor:n},className:a.imageDiv},o.a.createElement("img",{alt:"Candidate Headshot",onError:function(e){e.target.onError=null,e.target.src="/img/images.jpg"},src:"/image/".concat(t.cachedHeadFilename)}),o.a.createElement("div",{id:"partyCode"},t.partyCode)),o.a.createElement("div",{className:a.candidateLeftDiv},o.a.createElement("div",{className:a.candidateName},o.a.createElement("div",{id:"candidateFirst"},t.firstName),o.a.createElement("div",{id:"candidateLast"},t.lastName)),o.a.createElement("div",{id:"candidateIncumbent"},t.isIncumbent&&"Incumbent")),o.a.createElement("div",{className:a.candidateRightDiv},o.a.createElement("div",{className:a.votesDiv},o.a.createElement("div",{id:"votesPercent"},t.percent,"%"),o.a.createElement("div",{id:"votesTotal"},t.votes.toLocaleString("en")," total votes")),t.isElected?o.a.createElement("div",{id:"candidateElected"},o.a.createElement(z.a,{style:{paddingRight:5,fontSize:14,color:"green"}})," Elected"):o.a.createElement("div",{style:{fontSize:14}})))},k=function(e){var t=C(),n=e.data;return o.a.createElement("div",{className:t.resultsRoot},e.data&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:t.resultsInfo},o.a.createElement("div",{id:"pollsReported"},n.pollsReported,"/",n.pollsTotal," polls reported"),o.a.createElement("div",{id:"totalVotes"},n.votes.toLocaleString("en")," total votes")),o.a.createElement("div",null,e.data.results.map((function(t,n){var a=function(t){var n="#595b5b";if(e.parties){var a=e.parties.find((function(e){return e.nameShort===t.partyCode}));a&&(n=a.color)}return n}(t);return o.a.createElement(R,{screensize:e.screensize,key:n,color:a,candidate:t})})))))},L=Object(l.a)({sidebar:{flex:2,minWidth:250,position:"relative",display:"flex",overflow:"hidden"},title:{width:"100%",top:0,backgroundColor:"darkgrey",color:"white",display:"flex",alignItems:"center",minHeight:50,paddingLeft:10,fontWeight:"bolder"},content:{marginBottom:10,height:"calc(100% - 50px)",overflowX:"hidden",overflowY:"scroll"},LocationButton:{display:"flex",alignItems:"center",minHeight:50,paddingLeft:10,justifyContent:"space-between","&:hover":{backgroundColor:"lightgrey",cursor:"pointer"}}}),D=function(e){var t=Object(a.useState)(0),n=Object(c.a)(t,2),i=n[0],r=n[1],l=L(),s=Object(a.useState)("location"),d=Object(c.a)(s,2),u=d[0],m=d[1],f=Object(a.useState)(null),g=Object(c.a)(f,2),p=g[0],v=g[1];Object(a.useEffect)((function(){e.results&&(v(e.results),m("results"))}),[e.results]);var h=function(t){e.handleSelectRiding(t),v(t),m("results")},b=function(e){return o.a.createElement("div",{className:"".concat(l.LocationButton," menu-item"),onMouseEnter:function(){return r(e.resultId)},onMouseLeave:function(){return r(0)},onClick:function(){return h(e.resultData)}},e.children)};return o.a.createElement("div",{id:"widgetSidebar",className:l.sidebar},o.a.createElement("div",{style:{position:"absolute",top:0,height:"50px",width:"100%",backgroundColor:"darkgrey"}}),o.a.createElement(w.a,{in:"location"===u,timeout:500,unmountOnExit:!0,classNames:"menu-primary"},o.a.createElement("div",{className:"menu"},o.a.createElement("div",{className:l.title},"SELECT A RIDING"),o.a.createElement("div",{className:l.content},e.data&&e.data.data.sort((function(e,t){return e.name>t.name?1:-1})).map((function(e){return o.a.createElement(b,{key:e.id,resultId:e.id,resultData:e},e.name,i===e.id&&o.a.createElement(x.a,null))}))))),o.a.createElement(w.a,{in:"results"===u,unmountOnExit:!0,timeout:500,classNames:"menu-secondary"},o.a.createElement("div",{className:"menu"},o.a.createElement("div",{className:l.title},o.a.createElement(S.a,{onClick:function(){m("location"),e.handleSelectRiding(null)},style:{cursor:"pointer"}}),p&&p.name.toUpperCase()),o.a.createElement("div",{className:l.content},e.data&&"results"===u&&o.a.createElement(k,{screensize:e.small,data:p,parties:e.parties})))))},I=function(){return o.a.createElement("div",{className:"spinnerDiv"},o.a.createElement("div",{className:"spinnerText"},"Loading Map.."),o.a.createElement("div",{className:"spinner"},o.a.createElement("div",{className:"double-bounce1"}),o.a.createElement("div",{className:"double-bounce2"})))};o.a.memo((function(e){var t=e.data;return o.a.createElement("div",{style:{display:"none"}},t.data.map((function(e){return e.results.map((function(e){return o.a.createElement("img",{alt:"Candidate Headshot",onError:function(e){e.target.onError=null,e.target.src="/img/images.jpg"},src:"/image/".concat(e.cachedHeadFilename)})}))})))}));n(529);var W=Object(l.a)({app:{height:"100%",display:"flex",flexDirection:"row"}});var F=function(){var e=Object(a.useState)(null),t=Object(c.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)(!0),l=Object(c.a)(r,2),s=l[0],u=l[1],m=Object(a.useState)(null),f=Object(c.a)(m,2),g=f[0],p=f[1],v=Object(a.useState)(null),h=Object(c.a)(v,2),b=h[0],E=h[1],j=Object(a.useState)(3e5),S=Object(c.a)(j,2),O=S[0],x=(S[1],Object(a.useState)(window.innerWidth)),w=Object(c.a)(x,2),N=w[0],z=(w[1],W());Object(a.useEffect)((function(){console.log("Updating every ".concat(O/1e3," seconds")),R(),C()}),[]),Object(a.useEffect)((function(){k()}),[s]);var C=function(){setInterval((function(){R()}),O)},R=function(){console.log("fetching"),d.a.get("/fullresults").then((function(e){200===e.status&&(i(e.data),u(!1))})).catch((function(e){return console.log("Error fetching FULLELECTIONDATA, check your env variables and try again",e)})),d.a.get("/overallresults").then((function(e){200===e.status&&p(e.data.partyResults)})).catch((function(e){return console.log("Error fetching OVERALLRESULTS, check your env variables and try again")}))},k=function(){try{var e=window.location.hash;if(e){var t=e=decodeURI(e.replace("#",""));if(n){var a=n.data.find((function(e){return e.name.toLowerCase()===t.toLowerCase()}));a&&E(a)}}}catch(o){console.log("could not find riding by hash")}},L=function(e){E(e)};return o.a.createElement("div",{id:"map-widget-app",className:z.app},s?o.a.createElement(I,null):o.a.createElement(y,{data:n,parties:g,handleSelectRiding:L,selectedRiding:b}),o.a.createElement(D,{data:n,parties:g,results:b,handleSelectRiding:L,small:N}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(F,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[246,1,2]]]);
//# sourceMappingURL=main.c7031800.chunk.js.map